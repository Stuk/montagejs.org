montageDefine("3ed547c","observers",{dependencies:["collections/shim","collections/listen/property-changes","collections/listen/array-changes","collections/sorted-array","collections/map","collections/set","collections/heap","./scope","./operators","./parse","./compile-observer","./merge"],factory:function(e,t){function n(e){return function(t){return t(e)||Function.noop}}function r(e,t){return e(t.value)||Function.noop}function i(e,t){return e(t.parameters)||Function.noop}function a(e){return function(t,n){return t(n.document.getElementById(e))||Function.noop}}function o(e,t){return function(n,r){var i=r.components,a=i.getObjectByLabel||i.getComponentByLabel,o=a.call(i,e);return t.component=o,n(o)||Function.noop}}function s(e,t,n,r){function i(e,t,r){a(),a=n(e,t,r)||Function.noop}if(null==e)return n();var a=Function.noop;return pt.addOwnPropertyChangeListener(e,t,i,r.beforeChange),i(e[t],t,e),dt(function(){a(),pt.removeOwnPropertyChangeListener(e,t,i,r.beforeChange)})}function l(e,t){return function(n,r){return t(ht(function(t){return null==t?n():e(ht(function(e){return null==e?n():e.observeProperty?e.observeProperty(t,n,r):bt(e,t,n,r)}),r)}),r)}}function u(e,t,n,r){function i(e,r,i){o(t,r)&&(a(),a=n(e,t,i)||Function.noop)}var a=Function.noop,o=e.contentEquals||Object.equals;return i(e.get(t),t,e),e.addMapChangeListener(i,r.beforeChange),dt(function(){a(),e.removeMapChangeListener(i)})}function c(e,t){return function(n,r){return e(ht(function(e){return e?t(ht(function(t){return null==t?n():e.observeGet?e.observeGet(t,n,r):yt(e,t,n,r)}),r):n()}),r)}}function h(e,t){return function(n,r){return n=ut(n),t(ht(function(t){return e(ht(function(e){return e?U(e,function(){return n((e.has||e.contains).call(e,t))},r):n()}),r)}),r)}}function d(e){return function(t,n){for(var r=Array(e.length),i=0;e.length>i;i++)r[i]=void 0;var a=e.map(function(e,t){return e(function(e){r.set(t,e)},n)}),o=t(r)||Function.noop;return dt(function(){o(),ct(a)})}}function p(e){return function(t,n){var r={},i={};for(var a in e)(function(e,t){r[e]=t(function(t){i[e]=t},n)})(a,e[a]);var o=t(i)||Function.noop;return function(){o();for(var e in r)r[e]()}}}function f(){return d(Array.prototype.slice.call(arguments))}function m(e){return function(){var t=d(Array.prototype.slice.call(arguments)),n=K(t);return function(t,r){return n(ht(function(n){return n.every(_t.defined)?t(e.apply(void 0,n)):t()}),r)}}}function v(e){var t=e.slice(0,1).toUpperCase()+e.slice(1),n="make"+t+"Observer",r="observe"+t;return function(){var t=arguments[0],i=Array.prototype.slice.call(arguments,1),a=i.map(function(e){return function(t,n){return e(ht(t),n)}}),o=d(i),s=K(o);return function(i,o){return t(ht(function(t){return t?t[n]?t[n].apply(t,a)(i,o):t[r]?t[r](i,o):s(ht(function(n){return n.every(_t.defined)?"function"==typeof t[e]?i(t[e].apply(t,n)):i():i()}),o):i()}),o)}}}function g(e){return function(t,n){return e(ht(function(e){return t(!e)}),n)}}function _(e,t){return function(n,r){return e(ht(function(e){return e?t(n,r):n(e)}),r)}}function b(e,t){return function(n,r){return e(ht(function(e){return e?n(e):t(n,r)}),r)}}function y(e,t,n){return function(r,i){return e(ht(function(e){return null==e?r():e?t(r,i):n(r,i)}),i)}}function w(e){return function(t,n){return e(ht(function(e){return t(null!=e)}),n)}}function C(e,t){return function(n,r){return e(ht(function(e){return null==e?t(n,r):n(e)}),r)}}function E(e,t){return function(n,r){return e(ht(function(e){function i(t){for(;e.length>t;t++)s[t].index=t}function a(e,n,a){s.swap(a,n.length,e.map(function(e,t){return{index:a+t}})),i(a+e.length);var u,c=[];ct(l.swap(a,n.length,e.map(function(e,n){var i=s[a+n];return t(ht(function(e){u?o.set(i.index,e):c[n]=e}),gt.nest(r,e))}))),u=!0,o.swap(a,n.length,c)}if(!e)return n();var o=[],s=[],l=[],u=U(e,a,r),c=n(o,e)||Function.noop;return dt(function(){c(),ct(l),u()})}),r)}}function S(e,t){var n=E(e,t);return function(e,t){return n(ht(function(n,r){function i(e){for(;n.length>e;e++)l[e+1]=l[e]+n[e]}function a(e,t,n){var a=r.slice(n,n+e.length),s=t.map(Boolean).sum(),u=a.filter(function(t,n){return e[n]}),c=l[n],h=o.slice(c,c+s);(h.length!==u.length||h.every(function(e,t){return e!==u[t]}))&&o.swap(c,s,u),i(c)}if(!r)return e();var o=[],s=[],l=[0],u=U(n,a,t),c=e(o)||Function.noop;return dt(function(){c(),ct(s),u()})}),t)}}function P(e,t){var n=O(t),r=E(e,n),i=function(e,t){return r(ht(function(n){function r(e,t){a.addEach(e),a.deleteEach(t)}if(!n)return e();var i=[],a=ft(i,function(e,t){return Object.equals(e[1],t[1])},function(e,t){return Object.compare(e[1],t[1])}),o=U(n,r,t),s=e(i)||Function.noop;return function(){s(),o()}}),t)};return wt(i,Q)}function O(e){return function(t,n){return e(ht(function(e){return t([n.value,e])||Function.noop}),n)}}function M(e){return function(t,n){return e(ht(function(e){function r(e,t,n){var r=i.length-n-t.length;i.swap(r,t.length,e.reversed())}if(!e)return t();var i=[],a=U(e,r,n),o=t(i);return dt(function(){o(),a()})}),n)}}function T(e){return function(t,n){return e(ht(function(e){function r(t){for(var n=t;e.length>n;n++)l[n].index=n,s[n+1]=e[n]?s[n]+e[n].length:s[n]}function i(e,t,i){var u=s[i],c=s[i+t.length],h=c-u;a.swap(u,h,[]),l.swap(i,t.length,e.map(function(){return{index:null}})),r(i),ct(o.swap(i,t.length,e.map(function(e,t){function o(e,t,n){r(u.index);var i=s[u.index]+n,o=s[u.index]+n+t.length,l=o-i;a.swap(i,l,e)}var u=l[i+t];return U(e,o,n)})))}if(!e)return t();var a=[],o=[],s=[0],l=[],u=U(e,i,n),c=t(a)||Function.noop;return dt(function(){c(),ct(o),u()})}),n)}}function D(){return Et(d(Array.prototype.slice.call(arguments)))}function x(e,t){var n=Ct(e,t),r=l(n,St);return it(r,Boolean)}function k(e,t){var n=it(t,_t.not),r=Ct(e,n),i=l(r,St);return it(i,_t.not)}function L(e,t){var n=A(e,t);return Ot(n)}function A(e,t){var n=O(t),r=E(e,n);return function(e,t){return r(ht(function(n,r){function i(e,t){t.forEach(function(e){var t=a.get(e[1]);1===t.length?a["delete"](e[1]):t["delete"](e[0])}),e.forEach(function(e){var t,n=!a.has(e[1]);t=n?r.constructClone():a.get(e[1]),t.add(e[0]),n&&a.set(e[1],t)})}if(!n)return e();var a=mt(),o=U(n,i,t),s=e(a)||Function.noop;return function(){o(),s()}}),t)}}function j(e,t,n){function r(e,t){return Object.compare(e[1],t[1])*n}function i(e,t){return Object.equals(e[1],t[1])}var a=O(t),o=E(e,a);return function(e,t){return o(ht(function(n){function a(e,t){s.addEach(e),s.deleteEach(t)}function o(t,n){return 0===n?t?e(t[0]):e():void 0}if(!n)return e();var s=new vt(null,i,r),l=U(n,a,t),u=G(s,o,t);return function(){l(),u()}}),t)}}function I(e,t){return j(e,t,1)}function z(e,t){return j(e,t,-1)}function R(e){return function(t){return function(n,r){return n=ut(n),t(ht(function(t){if(!t)return n();var i=e(t,n);return U(t,function(e,t,r){return n(i(e,t,r))},r)}),r)}}}function B(e,t,n){return function(r,i){return e(ht(function(e){return e?n(ht(function(n){return null==n?r():t(ht(function(t){function a(r,i,a){var s=r.length-i.length;t>a&&0>s&&n>s?(o.swap(o.length,0,e.slice(t+n+s,t+n)),o.splice(0,-s)):t>a&&s>0&&n>s?(o.swap(0,0,e.slice(t,t+s)),o.splice(o.length-s,s)):a>=t&&0>s&&t+n>a?(o.swap(o.length,0,e.slice(t+n+s,t+n)),o.splice(a-t,-s)):a>=t&&s>0&&t+n>a?(o.swap(a-t,0,e.slice(a,a+s)),o.splice(o.length-s,s)):t+n>a&&o.swap(0,o.length,e.slice(t,t+n))}if(null==t)return r();var o=[],s=U(e,a,i),l=r(o)||Function.noop;return dt(function(){l(),s()})}),i)}),i):r()}),i)}}function F(e){return function(t,n){return e(ht(function(e){function r(e){for(;a.length>e;e++)a[e].set(0,e)}function i(e,t,n){a.swap(n,t.length,e.map(function(e,t){return[n+t,e]})),r(n+e.length)}if(!e)return t();var a=[],o=U(e,i,n),s=t(a)||Function.noop;return function(){s(),o()}}),n)}}function N(e){return function(t,n){var r=[],i=t(r)||Function.noop,a=e(function(e){if(e>>>=0,null==e)r.clear();else if(e>r.length){for(var t=[],n=r.length;e>n;n++)t.push(n);r.swap(r.length,0,t)}else r.length>e&&r.splice(e,r.length)},n);return function(){i(),a()}}}function q(e,t){return function(n,r){return t(function(t){var i=RegExp("^"+RegExp.escape(t));return e(function(e){return n(i.test(e))||Function.noop},r)},r)}}function W(e,t){return function(n,r){return t(function(t){var i=RegExp(RegExp.escape(t)+"$");return e(function(e){return n(i.test(e))||Function.noop},r)},r)}}function V(e,t){return function(n,r){return t(function(t){var i=RegExp(RegExp.escape(t));return e(function(e){return n(i.test(e))||Function.noop},r)},r)}}function U(e,t,n){function r(e,n,r){i(),i=t(e,n,r)||Function.noop}if(e){var i=Function.noop;if(e.toArray&&e.addRangeChangeListener){r(e.toArray(),[],0);var a=e.addRangeChangeListener(r,n.beforeChange);return dt(function(){i(),a()})}}}function H(e){return function(t,n){return e(ht(function(e){return Pt(e,t,n)}),n)}}function Y(e,t,n){function r(n,r,s){if(i+=n.length-r.length,!(i>s+r.length&&i>s+n.length)){var l=0>i?null:e.get(i);a(),a=t(l)||Function.noop,o=l}}var i=-1,a=Function.noop,o=null,s=U(e,r,n);return function(){a(),s()}}function K(e){return function(t,n){return e(ht(function(e){return e&&e.addRangeChangeListener?U(e,function(){return t(e)},n):t(e)}),n)}}function X(e){return function(t,n){return e(ht(function(e){return e&&e.addMapChangeListener?G(e,function(){return t(e)},n):t(e)}),n)}}function G(e,t,n){function r(e,n,r){var a=i.get(n)||Function.noop;i["delete"](n),a(),a=t(e,n,r)||Function.noop,void 0===e?a():i.set(n,a)}if(e.addMapChangeListener){var i=new mt;e.forEach(r);var a=e.addMapChangeListener(r,n.beforeChange);return dt(function(){i.forEach(function(e){e()}),a()})}}function J(e){return function(t,n){return e(ht(function(e){return e?$(e,t,n):t()}),n)}}function $(e,t,n){function r(e,t){var n,r;a.has(t)?null==e?(n=a.get(t),a["delete"](t),r=i.indexOf(n),i.splice(r,1)):(n=a.get(t),n.set(1,e)):(n=[t,e],a.set(t,n),i.push(n))}var i=[],a=mt(),o=t(i)||Function.noop,s=G(e,r,n)||Function.noop;return dt(function(){o(),s()})}function Z(e){var t=Ot(e);return wt(t,Q)}function Q(e,t){return t.value?e(t.value[0])||Function.noop:e()}function et(e){var t=Ot(e);return wt(t,tt)}function tt(e,t){return t.value?e(t.value[1])||Function.noop:e()}function nt(e){return function(t,n){var r=new mt,i=t(r)||Function.noop,a=e(ht(function(e){function t(e,t){void 0===e?r["delete"](t):r.set(t,e)}if(r.clear(),e&&"object"==typeof e){if(e.addRangeChangeListener)return Mt(ht(function(e){function t(e,t){t.forEach(function(e){r["delete"](e[0])}),e.forEach(function(e){r.set(e[0],e[1])})}return U(e,t,n)}),gt.nest(n,e));if(e.addMapChangeListener)return G(e,t,n);var i=Object.keys(e).map(function(t){return bt(e,t,ht(function(e){void 0===e?r["delete"](t):r.set(t,e)}),n)});return function(){ct(i)}}}),n);return function(){i(),a()}}}function rt(e){return function(t,n){return e(t,n.parent||new gt)}}function it(e,t,n){return function(r,i){return r=ut(r),e(ht(function(e){return r(t.call(n,e))}),i)}}function at(e,t,n){return function(r,i){return r=ut(r),e(ht(function(e){return e&&e.every(_t.defined)?r(t.apply(n,e)):void 0}),i)}}function ot(t,n){var r=e("./parse"),i=e("./compile-observer");return function(e,a){return e=ut(e),n(ht(function(n){if(null==n)return e();var o,s;try{o=r(n),s=i(o)}catch(l){return e()}return t(ht(function(t){return s(e,gt.nest(a,t))}),a)}),a)}}function st(e,t){return function(n,r){return e(ht(function(e){return t(ht(function(e){return n(e)}),gt.nest(r,e))}),r)}}function lt(e){return function(){var t=e.apply(this,arguments);return function(e,n){var r=[],i=t(ht(function(e){function t(e,t,n){r.swap(n,t.length,e)}if(e){Tt(r,e);var i=e.addRangeChangeListener(t,n.beforeChange);return dt(i)}r.clear()}),n),a=e(r)||Function.noop;return dt(function(){i(),a()})}}}function ut(e){var t;return function(n){if(n!==t){var r=e.apply(this,arguments);return t=n,r}}}function ct(e){e.forEach(function(e){e&&e()})}function ht(e){var t=Function.noop;return function(){return t(),t=e.apply(this,arguments)||Function.noop,function(){t()}}}function dt(e){var t;return function(){return t?Function.noop:(t=!0,e.apply(this,arguments))}}e("collections/shim");var pt=e("collections/listen/property-changes");e("collections/listen/array-changes");var ft=e("collections/sorted-array"),mt=e("collections/map");e("collections/set");var vt=e("collections/heap"),gt=e("./scope"),_t=e("./operators");t.makeLiteralObserver=n,t.observeValue=r,t.observeParameters=i,t.makeElementObserver=a,t.makeComponentObserver=o,t.observeProperty=s;var bt=s;t.makePropertyObserver=l,t.observeKey=u,t.observeGet=u;var yt=u;t.makeGetObserver=c,t.makeHasObserver=h,t.makeObserversObserver=d,t.makeRecordObserver=p,t.makeObjectObserver=p,t.makeTupleObserver=f,t.makeArrayObserver=f,t.makeOperatorObserverMaker=m,t.makeMethodObserverMaker=v,t.makeNotObserver=g,t.makeAndObserver=_,t.makeOrObserver=b,t.makeConditionalObserver=y,t.makeDefinedObserver=w,t.makeDefaultObserver=C;var wt=t.makeMapBlockObserver=lt(E),Ct=t.makeFilterBlockObserver=lt(S);t.makeSortedBlockObserver=P,t.makeReversedObserver=lt(M);var Et=t.makeFlattenObserver=lt(T);t.makeConcatObserver=D,t.makeSomeBlockObserver=x,t.makeEveryBlockObserver=k,t.makeGroupBlockObserver=L,t.makeGroupMapBlockObserver=A,t.makeMaxBlockObserver=I,t.makeMinBlockObserver=z;var St=n("length");t.makeSumObserver=R(function(){var e=0;return function(t,n){return e+=t.sum()-n.sum()}}),t.makeAverageObserver=R(function(){var e=0,t=0;return function(n,r){return e+=n.sum()-r.sum(),t+=n.length-r.length,e/t}}),t.makeViewObserver=lt(B),t.makeEnumerateObserver=lt(F),t.makeEnumerationObserver=t.makeEnumerateObserver,t.makeRangeObserver=N,t.makeStartsWithObserver=q,t.makeEndsWithObserver=W,t.makeContainsObserver=V,t.observeRangeChange=U,t.makeLastObserver=H,t.observeLast=Y;var Pt=Y;t.makeRangeContentObserver=K,t.makeMapContentObserver=X,t.observeMapChange=G;var Ot=t.makeEntriesObserver=lt(J);t.observeEntries=$,t.makeKeysObserver=Z,t.observeEntryKey=Q,t.makeValuesObserver=et,t.observeEntryValue=tt,t.makeToMapObserver=nt;var Mt=wt(L(r,Q),H(tt));t.makeParentObserver=rt,t.makeConverterObserver=it,t.makeComputerObserver=at,t.makePathObserver=ot,t.makeExpressionObserver=ot,t.makeWithObserver=st,t.makeToArrayObserver=lt(Function.identity),t.makeAsArrayObserver=t.makeToArrayObserver;var Tt=e("./merge").merge;t.makeUniq=ut,t.cancelEach=ct,t.autoCancelPrevious=ht,t.once=dt}});